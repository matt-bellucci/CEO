# Survey for Counterfactual Explanations for Ontologies (CEO)

A survey has been conducted on 6 domain experts.
The task is a musical instrument classification.
The code used to generate predictions was described in another paper and can be found here: https://git.litislab.fr/s4xai/ontology-based-image-classifier
Dataset and training method is also available at the same link.
For the survey, models were trained and test data was used to find inconsistent predictions.
The models cannot be stored on GitHub because of their size.

## Survey data

The results of the survey is available in the file `survey_data.csv`, each row corresponds to the answers of an expert and each column corresponds to the question and the case.


## How to reproduce survey explanations

The input image and corresponding individual generated by the system are given in the following.
Images are available in this folder.
For each case, the predicted class, the true class, the triples added to the ontology and the class imposed for the counterfactuals are given.
These triples can be added to the ontology file: `instruments.owl` to the individual *test*.
To generate counterfactuals, the individual *test* in the ontology must be given only the properties detected.
In the `main.py` file, the `counterfactual_class` variable must be set to `[onto.class]` where class is the exact name of the counterfactual class given for each case.
### Case 1
* Input image: `case_1.jpg`
* Instrument class predicted: Harpsichord
* True instrument class: Piano
* Counterfactual class: Harpsichord
* Properties detected:
  * hasTexture wood
  * hasTexture brassMetal
  * hasMechanism keyboard
  * hasMechanism pedals

### Case 2
* Input image: `case_2.jpg`
* Instrument class predicted: Trumpet
* True instrument class: Saxophone
* Counterfactual class: Saxophone
* Properties detected:
  * hasMechanism pistons
  * hasMouthpiece brassMouthpiece
  * hasTexture wood
  * hasTexture brassMetal

### Case 3
* Input image: `case_3.jpg`
* Instrument class predicted: Trumpet
* True instrument class: Trumpet
* Counterfactual class: BrassPipes
* Properties detected:
  * hasMouthpiece brassMouthpiece
  * hasTexture brassMetal
  * hasShape bell

### Case 4
* Input image: `case_4.jpg`
* Instrument class predicted: BrassPipes
* True instrument class: Contrabass
* Counterfactual class: Contrabass
* Properties detected:
  * hasMouthpiece reed
  * hasTexture brassMetal
  * hasMechanism keys

### Case 5
* Input image: `case_5.jpg`
* Instrument class predicted: Trombone
* True instrument class: Tuba
* Counterfactual class: Trombone
* Properties detected:
  * hasMouthpiece brassMouthpiece
  * hasTexture brassMetal
  * hasMechanism pistons
  * hasShape bell

### Case 6
* Input image: `case_6.jpg`
* Instrument class predicted: Bassoon
* True instrument class: Guitar
* Counterfactual class: Bassoon
* Properties detected:
  * hasApparentStrings strings
  * hasTexture wood
  * hasMechanism strings
  * hasMechanism keys

### Case 7
* Input image: `case_7.jpg`
* Instrument class predicted: Serpent
* True instrument class: Harp
* Counterfactual class: Serpent
* Properties detected:
  * hasApparentStrings strings
  * hasTexture wood
  * hasMechanism strings

### Case 8
* Input image: `case_8.jpg`
* Instrument class predicted: FrenchHorn
* True instrument class: Trumpet
* Counterfactual class: Trumpet
* Properties detected:
  * hasApparentStrings strings
  * hasTexture wood
  * hasMechanism strings

### Case 9
* Input image: `case_9.jpg`
* Instrument class predicted: BrassPipes
* True instrument class: FrenchHorn
* Counterfactual class: BrassPipes
* Properties detected:
  * hasShape bell
  * hasTexture brassMetal
  * hasMouthpiece reed
  * hasMechanism keys
